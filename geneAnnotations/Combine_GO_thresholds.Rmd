---
title: "Combine_GO_thresholds"
author: "Carson Stacy"
date: "2022-10-03"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Goal of this script is to concatenate the results from different outputs in canaryGO_analysis.Rmd into a new combined file with all of the information

```{r}
library(readr)
# MGLpost0_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/MGLpost0_up.csv")
# View(MGLpost0_up)
# MGLpost0_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/MGLpost0_down.csv")
# View(MGLpost0_down)
# 
# MGpost0_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/MGpost0_up.csv")
# View(MGpost0_up)
# MGpost0_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/MGpost0_down.csv")
# View(MGpost0_down)
# 
# MGd140_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/MGd140_up.csv")
# View(MGd140_up)
# MGd140_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/MGd140_down.csv")
# View(MGd140_down)


#MGd140
MGd140log2of1.01_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd140log2of1.01_up.csv") %>% mutate(direction = "up", lfc = 1.01, contrast = "MGd140") %>% rename("p.adj_up" = "p.adj")
MGd140log2of1.1_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd140log2of1.1_up.csv") %>% mutate(direction = "up", lfc = 1.1, contrast = "MGd140") %>% rename("p.adj_up" = "p.adj")
MGd140log2of1.2_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd140log2of1.2_up.csv") %>% mutate(direction = "up", lfc = 1.2, contrast = "MGd140") %>% rename("p.adj_up" = "p.adj")
MGd140log2of1.5_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd140log2of1.5_up.csv") %>% mutate(direction = "up", lfc = 1.5, contrast = "MGd140") %>% rename("p.adj_up" = "p.adj")
MGd140log2of2_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd140log2of2_up.csv") %>% mutate(direction = "up", lfc = 2, contrast = "MGd140") %>% rename("p.adj_up" = "p.adj")

MGd140log2of1.01_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd140log2of1.01_down.csv") %>% mutate(direction = "down", lfc = 1.01, contrast = "MGd140") %>% rename("p.adj_down" = "p.adj")
MGd140log2of1.1_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd140log2of1.1_down.csv") %>% mutate(direction = "down", lfc = 1.1, contrast = "MGd140") %>% rename("p.adj_down" = "p.adj")
MGd140log2of1.2_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd140log2of1.2_down.csv") %>% mutate(direction = "down", lfc = 1.2, contrast = "MGd140") %>% rename("p.adj_down" = "p.adj")
MGd140log2of1.5_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd140log2of1.5_down.csv") %>% mutate(direction = "down", lfc = 1.5, contrast = "MGd140") %>% rename("p.adj_down" = "p.adj")
MGd140log2of2_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd140log2of2_down.csv") %>% mutate(direction = "down", lfc = 2, contrast = "MGd140") %>% rename("p.adj_down" = "p.adj")

#MGpost0
MGpost0log2of1.01_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGpost0log2of1.01_up.csv") %>% mutate(direction = "up", lfc = 1.01, contrast = "MGpost0") %>% rename("p.adj_up" = "p.adj")
MGpost0log2of1.1_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGpost0log2of1.1_up.csv") %>% mutate(direction = "up", lfc = 1.1, contrast = "MGpost0") %>% rename("p.adj_up" = "p.adj")
MGpost0log2of1.2_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGpost0log2of1.2_up.csv") %>% mutate(direction = "up", lfc = 1.2, contrast = "MGpost0") %>% rename("p.adj_up" = "p.adj")
MGpost0log2of1.5_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGpost0log2of1.5_up.csv") %>% mutate(direction = "up", lfc = 1.5, contrast = "MGpost0") %>% rename("p.adj_up" = "p.adj")
MGpost0log2of2_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGpost0log2of2_up.csv") %>% mutate(direction = "up", lfc = 2, contrast = "MGpost0") %>% rename("p.adj_up" = "p.adj")

MGpost0log2of1.01_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGpost0log2of1.01_down.csv") %>% mutate(direction = "down", lfc = 1.01, contrast = "MGpost0") %>% rename("p.adj_down" = "p.adj")
MGpost0log2of1.1_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGpost0log2of1.1_down.csv") %>% mutate(direction = "down", lfc = 1.1, contrast = "MGpost0") %>% rename("p.adj_down" = "p.adj")
MGpost0log2of1.2_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGpost0log2of1.2_down.csv") %>% mutate(direction = "down", lfc = 1.2, contrast = "MGpost0") %>% rename("p.adj_down" = "p.adj")
MGpost0log2of1.5_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGpost0log2of1.5_down.csv") %>% mutate(direction = "down", lfc = 1.5, contrast = "MGpost0") %>% rename("p.adj_down" = "p.adj")
MGpost0log2of2_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGpost0log2of2_down.csv") %>% mutate(direction = "down", lfc = 2, contrast = "MGpost0") %>% rename("p.adj_down" = "p.adj")

#MGL
MGLpost0log2of1.01_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGLpost0log2of1.01_up.csv") %>% mutate(direction = "up", lfc = 1.01, contrast = "MGLpost0") %>% rename("p.adj_up" = "p.adj")
MGLpost0log2of1.1_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGLpost0log2of1.1_up.csv") %>% mutate(direction = "up", lfc = 1.1, contrast = "MGLpost0") %>% rename("p.adj_up" = "p.adj")
MGLpost0log2of1.2_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGLpost0log2of1.2_up.csv") %>% mutate(direction = "up", lfc = 1.2, contrast = "MGLpost0") %>% rename("p.adj_up" = "p.adj")
MGLpost0log2of1.5_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGLpost0log2of1.5_up.csv") %>% mutate(direction = "up", lfc = 1.5, contrast = "MGLpost0") %>% rename("p.adj_up" = "p.adj")
MGLpost0log2of2_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGLpost0log2of2_up.csv") %>% mutate(direction = "up", lfc = 2, contrast = "MGLpost0") %>% rename("p.adj_up" = "p.adj")

MGLpost0log2of1.01_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGLpost0log2of1.1_down.csv") %>% mutate(direction = "down", lfc = 1.01, contrast = "MGLpost0") %>% rename("p.adj_down" = "p.adj")
MGLpost0log2of1.1_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGLpost0log2of1.1_down.csv") %>% mutate(direction = "down", lfc = 1.1, contrast = "MGLpost0") %>% rename("p.adj_down" = "p.adj")
MGLpost0log2of1.2_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGLpost0log2of1.2_down.csv") %>% mutate(direction = "down", lfc = 1.2, contrast = "MGLpost0") %>% rename("p.adj_down" = "p.adj")
MGLpost0log2of1.5_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGLpost0log2of1.5_down.csv") %>% mutate(direction = "down", lfc = 1.5, contrast = "MGLpost0") %>% rename("p.adj_down" = "p.adj")
MGLpost0log2of2_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGLpost0log2of2_down.csv") %>% mutate(direction = "down", lfc = 2, contrast = "MGLpost0") %>% rename("p.adj_down" = "p.adj")


#MGd2114
MGd2114log2of1.01_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd2114log2of1.01_up.csv") %>% mutate(direction = "up", lfc = 1.01, contrast = "MGd2114") %>% rename("p.adj_up" = "p.adj")
MGd2114log2of1.1_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd2114log2of1.1_up.csv") %>% mutate(direction = "up", lfc = 1.1, contrast = "MGd2114") %>% rename("p.adj_up" = "p.adj")
MGd2114log2of1.2_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd2114log2of1.2_up.csv") %>% mutate(direction = "up", lfc = 1.2, contrast = "MGd2114") %>% rename("p.adj_up" = "p.adj")
MGd2114log2of1.5_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd2114log2of1.5_up.csv") %>% mutate(direction = "up", lfc = 1.5, contrast = "MGd2114") %>% rename("p.adj_up" = "p.adj")
MGd2114log2of2_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd2114log2of2_up.csv") %>% mutate(direction = "up", lfc = 2, contrast = "MGd2114") %>% rename("p.adj_up" = "p.adj")

MGd2114log2of1.01_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd2114log2of1.01_down.csv") %>% mutate(direction = "down", lfc = 1.01, contrast = "MGd2114") %>% rename("p.adj_down" = "p.adj")
MGd2114log2of1.1_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd2114log2of1.1_down.csv") %>% mutate(direction = "down", lfc = 1.1, contrast = "MGd2114") %>% rename("p.adj_down" = "p.adj")
MGd2114log2of1.2_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd2114log2of1.2_down.csv") %>% mutate(direction = "down", lfc = 1.2, contrast = "MGd2114") %>% rename("p.adj_down" = "p.adj")
MGd2114log2of1.5_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd2114log2of1.5_down.csv") %>% mutate(direction = "down", lfc = 1.5, contrast = "MGd2114") %>% rename("p.adj_down" = "p.adj")
MGd2114log2of2_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGd2114log2of2_down.csv") %>% mutate(direction = "down", lfc = 2, contrast = "MGd2114") %>% rename("p.adj_down" = "p.adj")


#MGP
MGPpost0log2of1.01_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGPpost0log2of1.01_up.csv") %>% mutate(direction = "up", lfc = 1.01, contrast = "MGPpost0") %>% rename("p.adj_up" = "p.adj")
MGPpost0log2of1.1_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGPpost0log2of1.1_up.csv") %>% mutate(direction = "up", lfc = 1.1, contrast = "MGPpost0") %>% rename("p.adj_up" = "p.adj")
MGPpost0log2of1.2_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGPpost0log2of1.2_up.csv") %>% mutate(direction = "up", lfc = 1.2, contrast = "MGPpost0") %>% rename("p.adj_up" = "p.adj")
MGPpost0log2of1.5_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGPpost0log2of1.5_up.csv") %>% mutate(direction = "up", lfc = 1.5, contrast = "MGPpost0") %>% rename("p.adj_up" = "p.adj")
MGPpost0log2of2_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGPpost0log2of2_up.csv") %>% mutate(direction = "up", lfc = 2, contrast = "MGPpost0") %>% rename("p.adj_up" = "p.adj")

MGPpost0log2of1.01_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGPpost0log2of1.1_down.csv") %>% mutate(direction = "down", lfc = 1.01, contrast = "MGPpost0") %>% rename("p.adj_down" = "p.adj")
MGPpost0log2of1.1_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGPpost0log2of1.1_down.csv") %>% mutate(direction = "down", lfc = 1.1, contrast = "MGPpost0") %>% rename("p.adj_down" = "p.adj")
MGPpost0log2of1.2_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGPpost0log2of1.2_down.csv") %>% mutate(direction = "down", lfc = 1.2, contrast = "MGPpost0") %>% rename("p.adj_down" = "p.adj")
MGPpost0log2of1.5_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGPpost0log2of1.5_down.csv") %>% mutate(direction = "down", lfc = 1.5, contrast = "MGPpost0") %>% rename("p.adj_down" = "p.adj")
MGPpost0log2of2_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_MGPpost0log2of2_down.csv") %>% mutate(direction = "down", lfc = 2, contrast = "MGPpost0") %>% rename("p.adj_down" = "p.adj")



# add Diet0 as a 'control' group to compare

#Diet0
Diet0log2of1.01_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_Diet0log2of1.01_up.csv") %>% mutate(direction = "up", lfc = 1.01, contrast = "Diet0") %>% rename("p.adj_up" = "p.adj")
Diet0log2of1.1_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_Diet0log2of1.1_up.csv") %>% mutate(direction = "up", lfc = 1.1, contrast = "Diet0") %>% rename("p.adj_up" = "p.adj")
Diet0log2of1.2_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_Diet0log2of1.2_up.csv") %>% mutate(direction = "up", lfc = 1.2, contrast = "Diet0") %>% rename("p.adj_up" = "p.adj")
Diet0log2of1.5_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_Diet0log2of1.5_up.csv") %>% mutate(direction = "up", lfc = 1.5, contrast = "Diet0") %>% rename("p.adj_up" = "p.adj")
Diet0log2of2_up <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_Diet0log2of2_up.csv") %>% mutate(direction = "up", lfc = 2, contrast = "Diet0") %>% rename("p.adj_up" = "p.adj")

Diet0log2of1.01_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_Diet0log2of1.1_down.csv") %>% mutate(direction = "down", lfc = 1.01, contrast = "Diet0") %>% rename("p.adj_down" = "p.adj")
Diet0log2of1.1_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_Diet0log2of1.1_down.csv") %>% mutate(direction = "down", lfc = 1.1, contrast = "Diet0") %>% rename("p.adj_down" = "p.adj")
Diet0log2of1.2_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_Diet0log2of1.2_down.csv") %>% mutate(direction = "down", lfc = 1.2, contrast = "Diet0") %>% rename("p.adj_down" = "p.adj")
Diet0log2of1.5_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_Diet0log2of1.5_down.csv") %>% mutate(direction = "down", lfc = 1.5, contrast = "Diet0") %>% rename("p.adj_down" = "p.adj")
Diet0log2of2_down <- read_csv("~/Documents/GitHub/CanarySeq/geneAnnotations/geneID2GO_Diet0log2of2_down.csv") %>% mutate(direction = "down", lfc = 2, contrast = "Diet0") %>% rename("p.adj_down" = "p.adj")
```
Combine the raw data
```{r}
MG_all <- rbind(
  MGd140log2of1.01_up,
  MGd140log2of1.1_up,
  MGd140log2of1.2_up,
  MGd140log2of1.5_up,
  MGd140log2of2_up,
  MGd140log2of1.01_down,
  MGd140log2of1.1_down,
  MGd140log2of1.2_down,
  MGd140log2of1.5_down,
  MGd140log2of2_down,
  MGpost0log2of1.01_up,
  MGpost0log2of1.1_up,
  MGpost0log2of1.2_up,
  MGpost0log2of1.5_up,
  MGpost0log2of2_up,
  MGpost0log2of1.01_down,
  MGpost0log2of1.1_down,
  MGpost0log2of1.2_down,
  MGpost0log2of1.5_down,
  MGpost0log2of2_down,
  MGLpost0log2of1.01_up,
  MGLpost0log2of1.1_up,
  MGLpost0log2of1.2_up,
  MGLpost0log2of1.5_up,
  MGLpost0log2of2_up,
  MGLpost0log2of1.01_down,
  MGLpost0log2of1.1_down,
  MGLpost0log2of1.2_down,
  MGLpost0log2of1.5_down,
  MGLpost0log2of2_down,
  MGd2114log2of1.01_up,
  MGd2114log2of1.1_up,
  MGd2114log2of1.2_up,
  MGd2114log2of1.5_up,
  MGd2114log2of2_up,
  MGd2114log2of1.01_down,
  MGd2114log2of1.1_down,
  MGd2114log2of1.2_down,
  MGd2114log2of1.5_down,
  MGd2114log2of2_down,
  MGPpost0log2of1.01_up,
  MGPpost0log2of1.1_up,
  MGPpost0log2of1.2_up,
  MGPpost0log2of1.5_up,
  MGPpost0log2of2_up,
  MGPpost0log2of1.01_down,
  MGPpost0log2of1.1_down,
  MGPpost0log2of1.2_down,
  MGPpost0log2of1.5_down,
  MGPpost0log2of2_down
)

Diet0_all <- rbind(
  Diet0log2of1.01_up,
  Diet0log2of1.1_up,
  Diet0log2of1.2_up,
  Diet0log2of1.5_up,
  Diet0log2of2_up,
  Diet0log2of1.01_down,
  Diet0log2of1.1_down,
  Diet0log2of1.2_down,
  Diet0log2of1.5_down,
  Diet0log2of2_down
)
```

```{r}
save(MG_all, file = "~/Documents/GitHub/CanarySeq/geneAnnotations/GOenriched_combined_results.RData")
save(Diet0_all, file = "~/Documents/GitHub/CanarySeq/geneAnnotations/GOenriched_Diet0_results.RData")
View(Diet0_all)
View(MG_all)
```

Another useful control:
Lipid control vs lipid t0 shouldn't be different
Same for protein. See what GO enrichments exist.
Hope we don't see any enrichments in those contrasts, means what we see is more likely legit.


Another main comparison to do: MG vs control for the protein birds and lipid birds.
Thing about six categories of how the genes can differ(same, different, updown, downup)

